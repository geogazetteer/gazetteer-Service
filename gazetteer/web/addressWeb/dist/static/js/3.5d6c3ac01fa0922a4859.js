webpackJsonp([3],{Mm1Y:function(t,e,s){"use strict";var i={name:"smallSpin",data:function(){return{}},components:{},computed:{},props:{msg:{type:[String]}},created:function(){},mounted:function(){},methods:{},beforedestroy:function(){},watch:{}},a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"spin-icon-load"},[e("Spin",{attrs:{fix:""}},[e("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),this._v(" "),this.msg?e("div",[this._v(this._s(this.msg))]):this._e()],1)],1)},staticRenderFns:[]};var n=s("VU/8")(i,a,!1,function(t){s("lPGJ")},"data-v-3c08583e",null);e.a=n.exports},Nawl:function(t,e){},WPs3:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Dd8w"),a=s.n(i),n=s("Mm1Y"),o=s("R4Sj"),r={name:"editBox",data:function(){return{needUser:!1,needSpin:!1,page:1,curStreet:"",allStreets:EDITSELECTORCFG.street,curCommunity:"",allCommunity:[],showList:!1,listArr:[],listCount:0,curEditIndex:-1,showEditModal:!1,editVisible:!1,editObj:[{label:"统一社会信用代码",val:"code",disabled:!0,necessary:!1,type:"text",needEdit:!1},{label:"企业名称",val:"name",disabled:!0,necessary:!1,type:"text",needEdit:!1},{label:"街道",val:"street",disabled:!0,necessary:!1,type:"text",needEdit:!0},{label:"社区",val:"community",disabled:!0,necessary:!1,type:"text",needEdit:!0},{label:"原地址",val:"originAddress",disabled:!0,necessary:!1,type:"textarea",needEdit:!0}],editValue:{code:"",name:"",street:"",community:"",originAddress:""},matchResult:[],curSelAddress:{},isEdit:!0}},components:{SmallSpin:n.a},computed:a()({},Object(o.c)(["changeToEdit"])),props:{},created:function(){},mounted:function(){},methods:{pageChanged:function(t,e){e=e||{needSelFirst:!0};this.page=t,this.getAddressByCommunity(!1,e)},onSelStreet:function(){var t=this.curStreet,e=this;if(t){var s=URLCFG.getCommunityByStreetUrl;e.$api.getMsg(s,{tablename:t}).then(function(t){e.allCommunity=t.rows,e.curCommunity=t.rows[0].community,e.getAddressByCommunity(!0,{needSelFirst:!0})})}},onSelCommunity:function(){this.curCommunity&&this.getAddressByCommunity(!0,{needSelFirst:!0})},getAddressByCommunity:function(t,e){var s=this;if(e=e||{},s.curEditIndex=-1,s.showList=!1,s.needSpin=!0,t=void 0==t||t){var i=URLCFG.getCountByCommunityUrl;s.$api.getMsg(i,{tablename:s.curCommunity}).then(function(t){s.listCount=t.total}),s.page=1}},toggleEditModal:function(t,e){var s=this;s.curSelAddress={},s.$api.getEditMsg(t,s.curCommunity).then(function(t){s.editValue={code:t.rows[0].code,name:t.rows[0].name,street:t.rows[0].street,community:s.curCommunity,originAddress:t.rows[0].address},s.showEditModal=!0,s.curEditIndex=e;var i=t.rows[0].address;s.$api.getMatchList(i).then(function(t){t.rows&&t.rows.length>0?(s.matchResult=t.rows,s.curSelAddress=t.rows[0]):(s.matchResult=[],s.curSelAddress={})})})},backRecord:function(){if(this.curEditIndex>0){var t=this.curEditIndex-1,e=this.listArr[t].fid;this.toggleEditModal(e,t)}else this.page>1&&(this.pageChanged(this.page-1,{needSelLast:!0}),this.curEditIndex=9)},nextRecord:function(){var t=Math.ceil(this.listCount/10);if(this.page<t)if(this.curEditIndex<9){var e=this.curEditIndex+1,s=this.listArr[e].fid;this.toggleEditModal(s,e)}else this.pageChanged(this.page+1,{needSelFirst:!0}),this.curEditIndex=0;else if(this.listCount%10==0&&this.curEditIndex<9||this.curEditIndex<this.listCount%10-1){e=this.curEditIndex+1,s=this.listArr[e].fid;this.toggleEditModal(s,e)}},submitEdit:function(){for(var t=this,e=this.editObj,s=0;s<e.length;s++);setTimeout(function(){t.editVisible=!1},1e3)}},beforedestroy:function(){},watch:{changeToEdit:{handler:function(t){if(t){var e=this;e.curEditIndex=-1,e.showList=!1,e.needSpin=!0;e.$api.getCount_edit("").then(function(t){e.listCount=t.total}),e.page=1,e.$api.getAddressByCommunity(e.page,e.curCommunity).then(function(t){e.needSpin=!1,e.listArr=t.rows,e.showList=!0,option.needSelFirst?e.toggleEditModal(t.rows[0].fid,0):option.needSelLast&&e.toggleEditModal(t.rows[9].fid,9)})}}}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"listView"},[i("div",{staticClass:"selector flex_row"},[i("div",{staticClass:"block flex_row"},[i("span",{staticClass:"label"},[t._v("街道：")]),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.curStreet,expression:"curStreet"}],staticClass:"select",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.curStreet=e.target.multiple?s:s[0]},t.onSelStreet]}},t._l(t.allStreets,function(e){return i("option",[t._v("\n            "+t._s(e)+"\n          ")])}),0)]),t._v(" "),i("div",{staticClass:"block flex_row"},[i("span",{staticClass:"label"},[t._v("社区：")]),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.curCommunity,expression:"curCommunity"}],staticClass:"select",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.curCommunity=e.target.multiple?s:s[0]},t.onSelCommunity]}},t._l(t.allCommunity,function(e){return i("option",[t._v("\n            "+t._s(e.community)+"\n          ")])}),0)]),t._v(" "),i("div",{staticClass:"flex_row toggle"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],on:{click:function(e){t.showList=!t.showList}}},[t._v("▲")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.showList,expression:"!showList"}],on:{click:function(e){t.showList=!t.showList}}},[t._v("▼")])])]),t._v(" "),t.needSpin?i("small-spin",{attrs:{msg:"正在加载……"}}):t._e(),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],staticClass:"siteList"},[t._l(t.listArr,function(e,a){return i("li",{staticClass:"flex_row",class:{sel:t.curEditIndex==a},on:{click:function(s){return t.toggleEditModal(e.fid,a)}}},[i("span",[t._v(t._s(e.address))]),t._v(" "),i("img",{staticClass:"imgItem",attrs:{src:s("wlOp")}})])}),t._v(" "),i("Page",{attrs:{current:t.page,total:t.listCount,"show-total":"",size:"small","class-name":"pageClass"},on:{"on-change":t.pageChanged}})],2)],1),t._v(" "),i("Modal",{attrs:{title:"地址编辑",mask:!1,styles:{width:"320px",position:"absolute",top:"75px",right:"20px",maxHeight:"80%"},scrollable:"",visible:t.editVisible},model:{value:t.showEditModal,callback:function(e){t.showEditModal=e},expression:"showEditModal"}},[t._l(t.editObj,function(e,s){return!t.isEdit||e.needEdit?i("div",{staticClass:"editLine flex_row",class:{autoHeightWrap:"textarea"==e.type}},[i("div",{staticClass:"label flex_row"},[i("span",{domProps:{innerHTML:t._s(e.label)}})]),t._v(" "),"text"==e.type?i("input",{directives:[{name:"model",rawName:"v-model",value:t.editValue[e.val],expression:"editValue[val.val]"}],class:e.disabled?"text":"text canEdit",attrs:{type:"text",title:t.editValue[e.val],disabled:e.disabled},domProps:{value:t.editValue[e.val]},on:{input:function(s){s.target.composing||t.$set(t.editValue,e.val,s.target.value)}}}):t._e(),t._v(" "),"textarea"==e.type?i("div",{staticClass:"autoHeight"},[t._v("\n        "+t._s(t.editValue[e.val])+"\n      ")]):t._e()]):t._e()}),t._v(" "),i("div",{staticClass:"editLine flex_row  autoHeightWrap"},[i("div",{staticClass:"label flex_row"},[i("span",[t._v("相似标准地址")])]),t._v(" "),i("div",{staticClass:"selectWrapper autoHeight flex_row"},[i("Select",{staticClass:"select",attrs:{placeholder:"无匹配数据"},model:{value:t.curSelAddress.address,callback:function(e){t.$set(t.curSelAddress,"address",e)},expression:"curSelAddress.address"}},t._l(t.matchResult,function(e,s){return i("Option",{key:s,attrs:{value:e.address,label:e.address}},[i("span",[t._v(t._s(e.address))]),t._v(" "),i("Progress",{staticClass:"similar_row",attrs:{"stroke-width":7,title:"相似度",percent:100*e.similarity}})],1)}),1),t._v(" "),t.isEdit?i("div",{staticClass:"editBtnWrap"},[i("Button",{attrs:{shape:"circle",icon:"md-create",title:"编辑",size:"small"},on:{click:t.showEditModal}})],1):t._e()],1)]),t._v(" "),i("div",{staticClass:"editLine flex_row autoHeightWrap"},[i("div",{staticClass:"label flex_row"},[i("span",[t._v("标准地址")])]),t._v(" "),t.curSelAddress.address?i("div",{staticClass:"autoHeight flex_row"},[i("span",[t._v(t._s(t.curSelAddress.address))]),t._v(" "),i("Progress",{staticClass:"similar",attrs:{vertical:"","stroke-width":7,title:"相似度",percent:100*t.curSelAddress.similarity}})],1):t._e(),t._v(" "),t.curSelAddress.address?t._e():i("div",{staticClass:"autoHeight flex_row"},[t._v("无匹配数据")])]),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{size:"small",disabled:1==t.page&&0==t.curEditIndex},on:{click:t.backRecord}},[i("Icon",{attrs:{type:"ios-arrow-back"}})],1),t._v(" "),i("Button",[t._v("取消")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.submitEdit}},[t._v("保存")]),t._v(" "),i("Button",{attrs:{size:"small",disabled:(t.curEditIndex==t.listCount%10-1||9==t.curEditIndex)&&t.page==Math.ceil(t.listCount/10)},on:{click:t.nextRecord}},[i("Icon",{attrs:{type:"ios-arrow-forward"}})],1)],1)],2)],1)},staticRenderFns:[]};var d={name:"home",components:{editBox:s("VU/8")(r,l,!1,function(t){s("oCb8")},"data-v-73e4fde1",null).exports,loading:s("KgXo").a},created:function(){},data:function(){return{upLoadUrl:EDITSERVICE.uploadUrl,showLoading:!1,disableUp:!1,openTarget:!1,targetData:null,targetList:[],targetListIndex:0}},computed:a()({},Object(o.c)(["username"])),methods:a()({},Object(o.b)(["updateChangeToEdit"]),{beforeUp:function(){this.username?this.disableUp=!1:this.disableUp=!0},beforeUpload:function(t){if(this.disableUp)return this.$Message.warning("请先登录"),!1;t.name.split(".")},onUpSuccess:function(t,e,s){this.$Message.success("导入成功!"),this.showLoading=!1,this.$api.initialUrl(this.usage).then(function(t){this.updateChangeToEdit(!0)})},onUpError:function(t,e,s){this.showLoading=!1,this.$Message.error("导入失败，请重试！")},toggleFix:function(t){if(this.username){var e=this;e.targetData=null,e.targetListIndex=t,e.$api.getTargetList().then(function(t){t?(e.openTarget=!0,e.targetList=t):(e.$Message.error("获取可下载的数据文件失败"),e.openTarget=!0,e.targetList=[])})}else this.$Message.warning("请先登录")},changeTarget:function(t){if(t){var e=this;1==e.targetListIndex?e.$api.setTarget(t).then(function(t){e.$Message.success("设置成功！")}).catch(function(t){t.response.data&&e.$Message.warning(t.response.data)}):e.$api.exportFile(t).then(function(t){t&&(e.$Message.warning("正在创建下载链接，请稍后……"),window.open(t))}).catch(function(t){t.response.data&&e.$Message.warning(t.response.data)})}}})},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"editWrapper"},[s("edit-box",{staticClass:"leftView"}),t._v(" "),s("div",{staticClass:"rightBox flex_row",on:{click:t.beforeUp}},[s("Upload",{ref:"upload",staticClass:"flex_row",attrs:{action:t.upLoadUrl,name:"fileName",accept:"file","before-upload":t.beforeUpload,"on-success":t.onUpSuccess,"on-error":t.onUpError,"show-upload-list":!1}},[s("Button",{staticClass:"item",attrs:{icon:"md-arrow-round-up"}},[t._v("导入")])],1),t._v(" "),s("div",{staticClass:"item flex_col"},[s("Button",{attrs:{icon:"md-download"},on:{click:function(e){return t.toggleFix(2)}}},[t._v("导出")])],1),t._v(" "),s("div",{staticClass:"item flex_col"},[s("Button",{attrs:{icon:"md-settings"},on:{click:function(e){return t.toggleFix(1)}}},[t._v("设置")])],1)],1),t._v(" "),t.showLoading?s("Spin",{staticStyle:{background:"rgba(255,255,255,.5)"},attrs:{fix:""}},[s("loading",{attrs:{msg:"上传中……"}})],1):t._e(),t._v(" "),t.openTarget?s("div",{staticClass:"tools"},[s("span",{staticClass:"arrow"}),t._v(" "),s("RadioGroup",{staticStyle:{width:"100%"},attrs:{vertical:""},on:{"on-change":t.changeTarget},model:{value:t.targetData,callback:function(e){t.targetData=e},expression:"targetData"}},[t._l(t.targetList,function(t){return s("Radio",{staticClass:"flex_row ellipsis",staticStyle:{width:"100%"},attrs:{label:t,title:t}})}),t._v(" "),0==t.targetList.length?s("div",{staticStyle:{color:"#969696"}},[t._v("可下载的数据文件")]):t._e()],2)],1):t._e()],1)},staticRenderFns:[]};var u=s("VU/8")(d,c,!1,function(t){s("Nawl")},"data-v-51b85826",null);e.default=u.exports},lPGJ:function(t,e){},oCb8:function(t,e){},wlOp:function(t,e){t.exports="data:image/png;base64,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"}});
//# sourceMappingURL=3.5d6c3ac01fa0922a4859.js.map